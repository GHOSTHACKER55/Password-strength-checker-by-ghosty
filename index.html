<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMILE MC | PREMIUM STORE üëë</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{font-family:'Plus Jakarta Sans',sans-serif;background:#0a0a0a;color:#fff;margin:0;padding-bottom:150px;}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);backdrop-filter:blur(15px);z-index:999;align-items:center;justify-content:center;}
.active-modal{display:flex;}
.portal-card{background:#fff;color:#000;border-radius:45px;padding:40px;width:95%;max-width:420px;max-height:90vh;overflow-y:auto;}
.toast{position:fixed;top:30px;left:50%;transform:translateX(-50%);background:#111;color:#fff;padding:18px 28px;border-radius:40px;font-size:12px;font-weight:900;opacity:0;transition:0.3s;z-index:9999;}
.toast.show{opacity:1;top:50px;}
.nav{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#111;padding:20px 40px;border-radius:50px;display:flex;gap:30px;}
.input-field{width:100%;padding:12px;border-radius:18px;border:2px solid #f0f0f0;margin-bottom:12px;outline:none;color:#000;font-weight:600;transition:all 0.2s;}
.input-field:focus{border-color:#000;background:#fff;}
.button-primary{width:100%;padding:16px;border-radius:20px;background:#000;color:#fff;font-weight:900;text-transform:uppercase;letter-spacing:1px;}
.step-hidden{display:none;}
</style>
</head>
<body>

<div id="toast" class="toast"></div>

<header class="p-6 flex justify-between items-center sticky top-0 bg-[#0a0a0a] z-50">
<h1 class="text-2xl font-black">SMILE MC üëë</h1>
<div id="user-display" class="text-xs opacity-40">Guest</div>
</header>

<main class="p-6 max-w-6xl mx-auto">

<!-- HOME PAGE -->
<section id="home-page">
<div id="product-grid" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
</section>

<!-- ADMIN PAGE -->
<section id="admin-page" class="hidden">
<div class="flex gap-4 mb-8 overflow-x-auto">
<button onclick="switchAdminTab('products')" id="btn-products" class="px-6 py-2 bg-white text-black rounded-full text-xs font-black">Products</button>
<button onclick="switchAdminTab('orders')" id="btn-orders" class="px-6 py-2 bg-[#111] text-gray-400 rounded-full text-xs font-black">Orders</button>
<button onclick="switchAdminTab('users')" id="btn-users" class="px-6 py-2 bg-[#111] text-gray-400 rounded-full text-xs font-black">Users</button>
</div>

<!-- PRODUCTS TAB -->
<div id="tab-products">
<div class="bg-[#111] p-6 rounded-3xl mb-6">
<h3 class="text-xs uppercase mb-4">Add Product</h3>
<input id="p-name" placeholder="NAME" class="input-field">
<input id="p-price" placeholder="PRICE" type="number" class="input-field">
<input id="p-desc" placeholder="DESCRIPTION" class="input-field">
<input type="file" id="p-file" class="input-field">
<button onclick="publishProduct()" class="button-primary">Publish</button>
</div>
<div id="inventory"></div>
</div>

<!-- ORDERS TAB -->
<div id="tab-orders" class="step-hidden"></div>

<!-- USERS TAB -->
<div id="tab-users" class="step-hidden"></div>
</section>

</main>

<!-- STAFF LOGIN MODAL -->
<div id="staffModal" class="modal">
<div class="portal-card">
<h2 class="text-xl font-black mb-6">STAFF LOGIN</h2>
<input id="staff-pass" type="password" placeholder="Enter Password" class="input-field">
<button onclick="verifyStaff()" class="button-primary">Unlock Admin</button>
<button onclick="closeStaff()" class="w-full text-xs opacity-30 mt-4">Cancel</button>
</div>
</div>

<!-- AUTH MODAL -->
<div id="authModal" class="modal">
<div class="portal-card">
<h2 id="auth-title" class="text-xl font-black mb-6">Create Account</h2>
<div id="signup-fields">
<input id="reg-name" placeholder="FULL NAME" class="input-field">
<input id="reg-phone" placeholder="WHATSAPP" class="input-field">
</div>
<input id="auth-email" placeholder="EMAIL" class="input-field">
<input id="auth-pass" type="password" placeholder="PASSWORD" class="input-field">
<button onclick="handleAuth()" id="auth-btn" class="button-primary">Register</button>
<p onclick="toggleMode()" class="text-center text-xs opacity-40 mt-3 cursor-pointer">Switch Mode</p>
<p onclick="resetPassword()" class="text-center text-xs text-blue-500 cursor-pointer">Forgot Password?</p>
<button onclick="closeAuth()" class="w-full text-xs opacity-30 mt-4">Cancel</button>
</div>
</div>

<!-- CHECKOUT MODAL -->
<div id="checkoutModal" class="modal">
<div class="portal-card">
<div id="check-step-1">
<h2 class="text-xl font-black mb-4">Order Details</h2>
<input id="ord-name" placeholder="Name" class="input-field">
<input id="ord-fullname" placeholder="Full Name" class="input-field">
<input id="ord-discord" placeholder="Discord ID" class="input-field">
<input id="ord-whatsapp" placeholder="WhatsApp (Optional)" class="input-field">
<button onclick="nextStep(2)" class="button-primary">Proceed To Pay</button>
</div>

<div id="check-step-2" class="step-hidden">
<h2 class="text-xl font-black mb-2">Payment</h2>
<p class="text-sm font-bold mb-1">Sumera Ismail</p>
<p class="text-xs font-bold mb-4">Easypaisa: 03209797510</p>
<button onclick="submitOrder()" class="button-primary mb-3">Checkout</button>
<button onclick="contactDiscord()" class="button-primary mb-3 bg-blue-600">Contact on Discord</button>
<button onclick="contactWhatsApp()" class="button-primary mb-3 bg-green-600">Contact on WhatsApp</button>
</div>
</div>
</div>

<nav class="nav">
<div onclick="openAuth()">üë§</div>
<div onclick="openStaff()">üõ°Ô∏è</div>
<div onclick="showPage('home')">üè†</div>
</nav>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, doc, setDoc, deleteDoc, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
apiKey: "AIzaSyC41Y6mNNBFvjNeHdOOWGsjczMjyaqoqjU",
authDomain: "fajar-collection-8aba3.firebaseapp.com",
projectId: "fajar-collection-8aba3",
storageBucket: "fajar-collection-8aba3.firebasestorage.app",
messagingSenderId: "620336064195",
appId: "1:620336064195:web:4608ae5f133de8fa17a476"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const STAFF_PASSWORD = "GHOSTYDEVELOPER";
const IMGBB_KEY = "ed019955ccdfc5952b136e449d727e0b";

let currentUser = null;
let selectedProduct = "";
let isSignup = true;

// TOAST FUNCTION
function toast(msg){const t=document.getElementById("toast");t.innerText=msg;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),3000);}

// SHOW PAGE
window.showPage = (id)=>{document.querySelectorAll('main>section').forEach(s=>s.classList.add('hidden'));document.getElementById(`${id}-page`).classList.remove('hidden');};
showPage('home');

// AUTH MODAL
window.openAuth = ()=>document.getElementById("authModal").classList.add("active-modal");
window.closeAuth = ()=>document.getElementById("authModal").classList.remove("active-modal");
window.toggleMode = ()=>{isSignup=!isSignup;document.getElementById("auth-title").innerText=isSignup?"Create Account":"Sign In";document.getElementById("auth-btn").innerText=isSignup?"Register":"Login";document.getElementById("signup-fields").style.display=isSignup?"block":"none";};
window.handleAuth=async()=>{
const email=document.getElementById("auth-email").value.trim();
const pass=document.getElementById("auth-pass").value.trim();
const name=document.getElementById("reg-name").value.trim();
const phone=document.getElementById("reg-phone").value.trim();
if(!email||!pass){toast("Fill all fields");return;}
try{
if(isSignup){
const res=await createUserWithEmailAndPassword(auth,email,pass);
await setDoc(doc(db,"users",res.user.uid),{name,phone,email,createdAt:serverTimestamp()});
toast("Account Created üëë");
}else{
await signInWithEmailAndPassword(auth,email,pass);
toast("Welcome Back üî•");
}
closeAuth();
}catch(e){toast(e.message);}
};
window.resetPassword=async()=>{
const email=document.getElementById("auth-email").value.trim();
if(!email){toast("Enter Email");return;}
await sendPasswordResetEmail(auth,email);
toast("Reset Email Sent ‚úâÔ∏è");
};
onAuthStateChanged(auth,user=>{currentUser=user;document.getElementById("user-display").innerText=user?"Connected":"Guest";});

// STAFF LOGIN
window.openStaff=()=>document.getElementById("staffModal").classList.add("active-modal");
window.closeStaff=()=>document.getElementById("staffModal").classList.remove("active-modal");
window.verifyStaff=()=>{const pass=document.getElementById("staff-pass").value.trim();if(pass===STAFF_PASSWORD){closeStaff();document.getElementById("admin-page").classList.remove("hidden");toast("Admin Access ‚úÖ");loadAdmin();}else{toast("Wrong Password ‚ùå");}};

// PUBLISH PRODUCT
window.publishProduct=async()=>{
const name=document.getElementById("p-name").value;
const price=document.getElementById("p-price").value;
const desc=document.getElementById("p-desc").value;
const file=document.getElementById("p-file").files[0];
if(!name||!price||!file){toast("All fields required");return;}
const fd=new FormData();fd.append("image",file);
const r=await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{method:"POST",body:fd});
const d=await r.json();
await addDoc(collection(db,"products"),{name,price,desc,image:d.data.url,createdAt:serverTimestamp()});
toast("Product Live üî•");
document.getElementById("p-name").value="";document.getElementById("p-price").value="";document.getElementById("p-desc").value="";document.getElementById("p-file").value="";
};

// LOAD PRODUCTS ON HOME & INVENTORY
onSnapshot(query(collection(db,"products"),orderBy("createdAt","desc")),snap=>{
document.getElementById("product-grid").innerHTML=snap.docs.map(d=>{const p=d.data();return `<div class="bg-[#111] rounded-3xl overflow-hidden"><img src="${p.image}" class="w-full aspect-square object-cover"><div class="p-4"><p class="text-xs opacity-40">${p.name}</p><p class="font-black text-lg">Rs.${p.price}</p><button onclick="startCheckout('${p.name}')" class="button-primary mt-2">Buy Now</button></div></div>`;}).join('');
document.getElementById("inventory").innerHTML=snap.docs.map(d=>{const p=d.data();return `<div class="bg-[#111] p-3 rounded-2xl flex justify-between items-center mb-2"><p class="text-xs font-black">${p.name}</p><button onclick="deleteDoc(doc(db,'products','${d.id}'))" class="text-red-500 text-xs font-black">Remove</button></div>`;}).join('');
});

// ADMIN TABS
window.switchAdminTab=(t)=>{document.querySelectorAll('#admin-page>div[id^="tab"]').forEach(tab=>tab.classList.add('step-hidden'));document.getElementById(`tab-${t}`).classList.remove('step-hidden');document.querySelectorAll('#admin-page button[id^="btn"]').forEach(b=>{b.classList.remove('bg-white','text-black');b.classList.add('bg-[#111]','text-gray-400');});document.getElementById(`btn-${t}`).classList.add('bg-white','text-black');};

// CHECKOUT
window.startCheckout=(p)=>{if(!currentUser){openAuth();return;}selectedProduct=p;document.getElementById("checkoutModal").classList.add("active-modal");document.getElementById("check-step-1").classList.remove("step-hidden");document.getElementById("check-step-2").classList.add("step-hidden");};
window.nextStep=(s)=>{if(s==2){document.getElementById("check-step-1").classList.add("step-hidden");document.getElementById("check-step-2").classList.remove("step-hidden");}};
window.submitOrder=async()=>{
const name=document.getElementById("ord-name").value,fullname=document.getElementById("ord-fullname").value,discord=document.getElementById("ord-discord").value,wa=document.getElementById("ord-whatsapp").value||"N/A";
await addDoc(collection(db,"orders"),{product:selectedProduct,name,fullname,discord,wa,timestamp:serverTimestamp()});
toast("Order Placed ‚úÖ");};
window.contactDiscord=()=>{const name=document.getElementById("ord-name").value,fullname=document.getElementById("ord-fullname").value,discord=document.getElementById("ord-discord").value,wa=document.getElementById("ord-whatsapp").value||"N/A";window.open(`https://discord.com/users/devil_hunter_______?message=Order:%20${selectedProduct}%0AName:%20${name}%0AFullName:%20${fullname}%0ADiscord:%20${discord}%0AWhatsApp:%20${wa}`,'_blank');};
window.contactWhatsApp=()=>{const name=document.getElementById("ord-name").value,fullname=document.getElementById("ord-fullname").value,discord=document.getElementById("ord-discord").value,wa=document.getElementById("ord-whatsapp").value||"N/A";window.open(`https://wa.me/003706116030?text=Order:%20${selectedProduct}%0AName:%20${name}%0AFullName:%20${fullname}%0ADiscord:%20${discord}%0AWhatsApp:%20${wa}`,'_blank');};

// LOAD ADMIN ORDERS AND USERS
function loadAdmin(){
onSnapshot(query(collection(db,"orders"),orderBy("timestamp","desc")),snap=>{document.getElementById("tab-orders").innerHTML=snap.docs.map(d=>{const o=d.data();return `<div class="bg-[#111] p-4 rounded-2xl flex justify-between items-start mb-2"><div><p class="text-xs font-black text-blue-400">${o.product}</p><p class="text-xs">${o.name} | ${o.fullname}</p><p class="text-xs">Discord: ${o.discord}</p><p class="text-xs">WA: ${o.wa}</p></div><button onclick="deleteDoc(doc(db,'orders','${d.id}'))" class="text-red-500 text-xs font-black">Delete</button></div>`;}).join('');});
onSnapshot(collection(db,"users"),snap=>{document.getElementById("tab-users").innerHTML=snap.docs.map(d=>{const u=d.data();return `<div class="bg-[#111] p-4 rounded-2xl flex justify-between items-center mb-2"><p class="text-xs font-black">${u.name} | ${u.email} | ${u.phone}</p><button onclick="deleteDoc(doc(db,'users','${d.id}'))" class="text-red-500 text-xs font-black">Remove</button></div>`;}).join('');});
}
</script>
</body>
</html>